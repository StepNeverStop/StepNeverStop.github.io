<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta name="google-site-verification" content="zu-9nWphPjrzXV8v514mkHknIz4dNfHlib56-KNAu44">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">





<script>
(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/356f1943.js","daovoice")
daovoice('init', {
  app_id: "356f1943"
});
daovoice('update');
</script>














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="rl,">





  <link rel="alternate" href="/atom.xml" title="Keavnn'Blog" type="application/atom+xml">





<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码','') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

<meta name="description" content="这篇论文介绍了优先经验回放机制，它可以使学习过程更高效。 推荐：  实用技巧 通俗易懂">
<meta name="keywords" content="rl">
<meta property="og:type" content="article">
<meta property="og:title" content="Prioritized Experience Replay">
<meta property="og:url" content="http://StepNeverStop.github.io/Prioritized-Experience-Replay.html">
<meta property="og:site_name" content="Keavnn&#39;Blog">
<meta property="og:description" content="这篇论文介绍了优先经验回放机制，它可以使学习过程更高效。 推荐：  实用技巧 通俗易懂">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://stepneverstop.github.io/Prioritized-Experience-Replay/pseudo.png">
<meta property="og:image" content="http://stepneverstop.github.io/Prioritized-Experience-Replay/sum-tree.png">
<meta property="og:image" content="http://stepneverstop.github.io/Prioritized-Experience-Replay/learning-speed.png">
<meta property="og:image" content="http://stepneverstop.github.io/Prioritized-Experience-Replay/normalized-score1.png">
<meta property="og:image" content="http://stepneverstop.github.io/Prioritized-Experience-Replay/normalized-score.png">
<meta property="og:updated_time" content="2019-10-16T14:13:36.842Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Prioritized Experience Replay">
<meta name="twitter:description" content="这篇论文介绍了优先经验回放机制，它可以使学习过程更高效。 推荐：  实用技巧 通俗易懂">
<meta name="twitter:image" content="http://stepneverstop.github.io/Prioritized-Experience-Replay/pseudo.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://StepNeverStop.github.io/Prioritized-Experience-Replay.html">





  <title>Prioritized Experience Replay | Keavnn'Blog</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/StepNeverStop" class="github-corner" aria-label="View source on GitHub" rel="external nofollow" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Keavnn'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">If it is to be, it is up to me.</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://StepNeverStop.github.io/Prioritized-Experience-Replay.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Keavnn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/Kicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Keavnn'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Prioritized Experience Replay</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-22T08:54:44+08:00">
                2019-05-22
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2019-10-16T22:13:36+08:00">
                2019-10-16
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/ReinforcementLearning/" itemprop="url" rel="index">
                    <span itemprop="name">ReinforcementLearning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  16
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>这篇论文介绍了优先经验回放机制，它可以使学习过程更高效。</p>
<p>推荐：</p>
<ul>
<li>实用技巧</li>
<li>通俗易懂</li>
</ul>
<a id="more"></a>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>论文地址：<a href="https://arxiv.org/pdf/1511.05952.pdf" rel="external nofollow" target="_blank">https://arxiv.org/pdf/1511.05952.pdf</a></p>
<p>之前重用经验（experience，transition转换五元组$\lt s,a,r,s’,done \ or \ \gamma\gt$都是从经验池中<strong>均匀采样</strong>，忽略了经验的重要程度，文中提到的优先经验回放框架按经验重要性增大其被采样到的概率，希望越重要的经验使用次数越多，从而增加学习效率。</p>
<p>文中应用算法：DQN</p>
<p>效果：相比传统经验池机制，Atari 49游戏中41胜，8负</p>
<h1 id="文中精要"><a href="#文中精要" class="headerlink" title="文中精要"></a>文中精要</h1><blockquote>
<p>Online reinforcement learning (RL) agents incrementally update their parameters (of the policy, value function or model) while they observe a stream of experience. In their simplest form, they discard incoming data immediately, after a single update. Two issues with this are (a) strongly correlated updates that break the i.i.d. assumption of many popular stochastic gradient-based algorithms, and (b) the rapid forgetting of possibly rare experiences that would be useful later on.<br>Experience replay  addresses both of these issues: with experience stored in a replay memory, it becomes possible to break the temporal correlations by mixing more and less recent experience for the updates, and rare experience will be used for more than just a single update.</p>
</blockquote>
<p>指出On-policy一般使用一个episode的数据进行参数更新，且数据用完即丢，这样做有两个缺点：</p>
<ul>
<li>数据（状态）相互关联，数据不具有独立同分布($i.i.d$)的性质，但许多流行的随机梯度算法往往有关于数据独立同分布的假设</li>
<li>对罕见的（稀疏的）经验快速遗忘，忽略了这些罕见经验可能多次更新更有用的作用</li>
</ul>
<p><strong>经验池机制解决了上述两个问题</strong>，通过混合近期经验打破它们关于时间的关联性，并从经验池中采样经验学习多次。</p>
<p>经验池机制的优势：</p>
<ul>
<li>稳定了DQN值函数的训练</li>
<li>一般情况下，经验回放可以减少训练所需的经验数量，但是需要加大计算量，消耗更多的内存，但是这往往比智能体与环境进行交互来得更方便、容易</li>
</ul>
<blockquote>
<p>In particular, we propose to more frequently replay transitions with high expected learning progress, s measured by the magnitude of their temporal-difference (TD) error. This prioritization can lead o a loss of diversity, which we alleviate with stochastic prioritization, and introduce bias, which e correct with importance sampling. </p>
</blockquote>
<p>文中根据TD-error设置优先经验回放的频率，这可能会引起两个问题：</p>
<ul>
<li>丢失样本多样性</li>
<li>引入偏差</li>
</ul>
<p>分别解决方案：</p>
<ul>
<li>随机优先级 stochastic prioritization</li>
<li>重要性采样</li>
</ul>
<blockquote>
<p>The central component of prioritized replay is the criterion by which the importance of each transition is measured. One idealised criterion would be the amount the RL agent can learn from a transition in its current state (expected learning progress). While this measure is not directly accessible,  reasonable proxy is the magnitude of a transition’s TD error $\delta$ indicates how ‘surprising’  or unexpected the transition is: specifically, how far the value is from its next-step bootstrap estimate.</p>
</blockquote>
<p>优先经验回放的核心部分是如何衡量样本的重要性，并根据其重要性进行回放。</p>
<p>最直观的衡量标准是从经验样本中可以学习的量，但是这个量不可知、不可得，于是使用TD-error $\delta$作为这个量的替代品以衡量样本重要性。 </p>
<blockquote>
<p>New transitions arrive without a known TD-error, so we put them at maximal priority in order to guarantee that all experience is seen at least once.  </p>
</blockquote>
<p>新的经验被存入经验池时不需计算TD-error，直接将其设置为当前经验池中最大的TD-error，保证其至少被抽中一次。</p>
<hr>
<p>既然使用TD-error作为衡量可学习的度量，那么完全可以用贪婪的方式，选取TD-error最大的几个进行学习，但这会有几个问题：</p>
<ol>
<li>由于只有在经验被重放<strong>之后</strong>，这个经验的TD-error才被更新，导致初始TD-error比较小的经验长时间不被使用，甚至永远不被使用。</li>
<li>贪婪策略聚焦于一小部分TD-error比较高的经验，当使用值函数近似时，这些经验的TD-error减小速度很慢，导致这些经验被高频重复使用，致使样本缺乏多样性而过拟合。</li>
</ol>
<p>文中提到使用<strong>随机采样方法 stochastic sampling method</strong>在贪婪策略与均匀采样之间“差值”来解决上述问题，其实它是一个在样本使用上的trade-off，由超参数$\alpha$控制</p>
<p>使用优先经验回放还有一个问题是改变了状态的分布，我们知道DQN中引入经验池是为了解决数据相关性，使数据（尽量）独立同分布的问题。但是使用优先经验回放又改变了状态的分布，这样势必会引入偏差bias，对此，文中使用<strong>偏差退火——重要性采样结合退火因子</strong>，来消除引入的偏差。</p>
<h2 id="随机采样方法"><a href="#随机采样方法" class="headerlink" title="随机采样方法"></a>随机采样方法</h2><script type="math/tex; mode=display">
P(i)=\frac{p^{\alpha}_{i}}{\sum_{k}p^{\alpha}_{k}}</script><p>$\alpha$超参数控制采样在uniform和greedy的偏好，是一个trade-off因子：</p>
<ul>
<li>$\alpha=0$，均匀采样</li>
<li>$\alpha=1$，贪婪策略采样</li>
<li>$\alpha \in [0,1]$，文中没有明说$\alpha$的取值范围</li>
<li>引入$\alpha$不改变优先级的单调性，只是适当调整高、低TD-error经验的优先级</li>
</ul>
<p>根据优先级$p_{i}$的设定可以将优先经验池的设计分为两种：</p>
<ul>
<li>直接的，基于比例的，proportional prioritization</li>
<li>间接的，基于排名的，rank-based prioritization</li>
</ul>
<h3 id="Proportional-Prioritization"><a href="#Proportional-Prioritization" class="headerlink" title="Proportional Prioritization"></a>Proportional Prioritization</h3><script type="math/tex; mode=display">
p_{i}=\left | \delta_{i} \right | + \epsilon</script><ul>
<li>$\delta$表示TD-error</li>
<li>$\epsilon$是一个小的正常数，防止TD-error为0的经验永远不被重放。</li>
</ul>
<h3 id="Rank-based-Prioritization"><a href="#Rank-based-Prioritization" class="headerlink" title="Rank-based Prioritization"></a>Rank-based Prioritization</h3><script type="math/tex; mode=display">
p_{i}=\frac{1}{rank(i)}</script><ul>
<li>$rank(i)$是经验根据$\left | \delta_{i} \right |$大小排序的排名</li>
<li>$P$为指数$\alpha$的幂律分布power-law distribution</li>
<li>这种方式更具鲁棒性，因为其对异常点不敏感，主要是因为异常点的TD-error过大或过小对rank值没有太大影响</li>
</ul>
<p>优点：</p>
<ul>
<li>其重尾性、厚尾性、heavy-tail property保证采样多样性</li>
<li>分层采样使mini-batch的梯度稳定</li>
</ul>
<p>缺点：</p>
<ul>
<li>当在稀疏奖励场景想要使用TD-error分布结构时，会造成性能下降</li>
</ul>
<h3 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h3><p>根据文中实验，两种方式效果基本相同，但不同场景可能一个效果很好，一个效果一般般。作者<strong>猜想</strong>效果相同的原因可能是因为对奖励和TD-error大量使用clip操作，消除了异常值，作者本以为Rank-based更具鲁棒性的。</p>
<blockquote>
<p>Overhead is similar to rank-based prioritization.</p>
</blockquote>
<p>两者开销相同。</p>
<h2 id="偏差退火-Annealing-The-Bias"><a href="#偏差退火-Annealing-The-Bias" class="headerlink" title="偏差退火 Annealing The Bias"></a>偏差退火 Annealing The Bias</h2><p>我觉得应该译为消除偏差。</p>
<p>引入重要性采样、引入退火因子$\beta$消除偏差。将$w_{i}$除以$max_{i}w_{i}$向下缩放（减小）梯度更新幅度，稳定算法</p>
<script type="math/tex; mode=display">
w_{i}=\left ( \frac{1}{N} \cdot \frac{1}{P(i)} \right )^{\beta}</script><ul>
<li>$\beta=0$，完全不用重要性采样</li>
<li>$\beta=1$，常规重要性采样</li>
<li><strong>在训练接近尾声时，使$\beta \rightarrow 1$ </strong></li>
<li>$\beta \in [0,1]$，文中并没有明说$\beta$的取值范围</li>
<li>$\beta$的选择与$\alpha$有关，但文中并没有说明这两个参数如何选择的关系</li>
</ul>
<p>作用：</p>
<ul>
<li>消除偏差</li>
</ul>
<blockquote>
<p>We therefore exploit the flexibility of annealing the amount of importance-sampling correction over time, by defining a schedule on the exponent β that reaches 1 only at the end of learning.</p>
</blockquote>
<p>应用退火重要性采样校正量的灵活性，使在学习快结束时，将$\beta \rightarrow 1$</p>
<h1 id="伪代码"><a href="#伪代码" class="headerlink" title="伪代码"></a>伪代码</h1><p><img src="./Prioritized-Experience-Replay/pseudo.png" alt=""></p>
<p><strong>解析</strong>：</p>
<ul>
<li>step-size $\eta$可以看做是学习率，文中并没有说它具体的定义，只是说它可以调节参数更新幅度（不就是学习率嘛）</li>
<li>$K$代表采样与更新之间的步数差，也就是，先采样K次经验并存入经验池，再取mini-batch更新。</li>
<li>采样方式：<ul>
<li><img src="./Prioritized-Experience-Replay/sum-tree.png" alt=""></li>
<li>采样与更新TD-error的时间复杂度为$O(log_{2}N)$</li>
</ul>
</li>
<li>学习完之后对学习使用的经验更新其TD-error</li>
<li>重要性权重$w_{j}=\left ( N \cdot P(j)\right )^{-\beta}/max_{i}w_{i}$，由$max_{i}w_{i}=max_{i}\left ( N \cdot P(i)\right )^{-\beta}=\left ( min_{i}N \cdot P(i)\right )^{-\beta}=\left ( N \cdot P_{min}\right )^{-\beta}$,可以将其化简为$w_{j}=\left ( \frac{p_{min}}{p_{j}} \right )^{\beta}$</li>
<li>第12行，赋值其实是$(\left | \delta_{i} \right |+ \epsilon)^{\alpha}$，如果是rank-based，则为$rank(i)^{-\alpha}$</li>
<li>第6行，对于新采样到的经验，不必计算其TD-error，直接将其设置为最大即可，当使用该经验学习之后再计算其TD-error</li>
<li>$\Delta$其实就是误差函数$\delta^{2}$对$\theta$的导数，只不过对于mini-batch中的各个经验使用重要性比率进行了加权求和。</li>
</ul>
<p><strong>注意</strong>：</p>
<blockquote>
<p>Our final  solution was to store transitions in a priority queue implemented with an array-based binary heap. The heap array was then directly used as an approximation of a sorted array, which is infrequently sorted once every $10^{6}$ steps to prevent the heap becoming too unbalanced. </p>
</blockquote>
<p>如果使用rank-based方法，则使用的不是sum-tree结构，而是二进制堆，由于我不了解这个结构，故目前不做阐述。</p>
<h1 id="Sum-Tree"><a href="#Sum-Tree" class="headerlink" title="Sum Tree"></a>Sum Tree</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sum_Tree</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, capacity)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        capacity = 5，设置经验池大小</span></span><br><span class="line"><span class="string">        tree = [0,1,2,3,4,5,6,7,8,9,10,11,12] 8-12存放叶子结点p值，1-7存放父节点、根节点p值的和，0存放树节点的数量</span></span><br><span class="line"><span class="string">        data = [0,1,2,3,4,5] 1-5存放数据， 0存放capacity</span></span><br><span class="line"><span class="string">        Tree structure and array storage:</span></span><br><span class="line"><span class="string">        Tree index:</span></span><br><span class="line"><span class="string">                    1         -&gt; storing priority sum</span></span><br><span class="line"><span class="string">              /          \ </span></span><br><span class="line"><span class="string">             2            3</span></span><br><span class="line"><span class="string">            / \          / \</span></span><br><span class="line"><span class="string">          4     5       6   7</span></span><br><span class="line"><span class="string">         / \   / \     / \  / \</span></span><br><span class="line"><span class="string">        8   9 10   11 12                   -&gt; storing priority for transitions</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">assert</span> capacity != <span class="number">1</span></span><br><span class="line">        self.now = <span class="number">0</span></span><br><span class="line">        self.parent_node_count = self.get_parent_node_count(capacity)</span><br><span class="line">        print(self.parent_node_count)</span><br><span class="line">        self.tree = np.zeros(self.parent_node_count + capacity + <span class="number">1</span>)</span><br><span class="line">        self.tree[<span class="number">0</span>] = len(self.tree) - <span class="number">1</span></span><br><span class="line">        self.data = np.zeros(capacity + <span class="number">1</span>, dtype=object)</span><br><span class="line">        self.data[<span class="number">0</span>] = capacity</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, p, data)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        p : 优先级</span></span><br><span class="line"><span class="string">        data : 数据元组</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        tree_index = self.now + self.parent_node_count + <span class="number">1</span></span><br><span class="line">        self.data[self.now + <span class="number">1</span>] = data</span><br><span class="line">        self._updatetree(tree_index, p)</span><br><span class="line">        self.now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self.now &gt; self.data[<span class="number">0</span>]:</span><br><span class="line">            self.now = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_updatetree</span><span class="params">(self, tree_index, p)</span>:</span></span><br><span class="line">        diff = p - self.tree[tree_index]</span><br><span class="line">        self._propagate(tree_index, diff)</span><br><span class="line">        self.tree[tree_index] = p</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_propagate</span><span class="params">(self, tree_index, diff)</span>:</span></span><br><span class="line">        parent = tree_index // <span class="number">2</span></span><br><span class="line">        self.tree[parent] += diff</span><br><span class="line">        <span class="keyword">if</span> parent != <span class="number">1</span>:</span><br><span class="line">            self._propagate(parent, diff)</span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">total</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.tree[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, seg_p_total)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        seg_p_total : 要采样的p的值</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        tree_index = self._retrieve(<span class="number">1</span>, seg_p_total)</span><br><span class="line">        data_index = tree_index - self.parent_node_count</span><br><span class="line">        <span class="keyword">return</span> (tree_index, data_index, self.tree[tree_index], self.data[data_index])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_retrieve</span><span class="params">(self, tree_index, seg_p_total)</span>:</span></span><br><span class="line">        left = <span class="number">2</span> * tree_index</span><br><span class="line">        right = left + <span class="number">1</span></span><br><span class="line"><span class="comment">#         left = 2 * tree_index + 1</span></span><br><span class="line"><span class="comment">#         right = 2 * (tree_index + 1)</span></span><br><span class="line">        <span class="keyword">if</span> left &gt;= self.tree[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> tree_index</span><br><span class="line">        <span class="keyword">return</span> self._retrieve(left, seg_p_total) <span class="keyword">if</span> seg_p_total &lt;= self.tree[left] <span class="keyword">else</span> self._retrieve(right, seg_p_total - self.tree[left])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pp</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(self.tree, self.data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_parent_node_count</span><span class="params">(self, capacity)</span>:</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            <span class="keyword">if</span> pow(<span class="number">2</span>, i) &lt; capacity &lt;= pow(<span class="number">2</span>, i + <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">return</span> pow(<span class="number">2</span>, i + <span class="number">1</span>) - <span class="number">1</span></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tree = Sum_Tree(<span class="number">5</span>)</span><br><span class="line">tree.add(<span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line">tree.add(<span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">tree.add(<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">tree.add(<span class="number">4</span>, <span class="number">6</span>)</span><br><span class="line">tree.add(<span class="number">6</span>, <span class="number">11</span>)</span><br><span class="line">tree.pp()</span><br><span class="line">print(tree.get(<span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<h1 id="优先经验回放的特点"><a href="#优先经验回放的特点" class="headerlink" title="优先经验回放的特点"></a>优先经验回放的特点</h1><ol>
<li>新的transition被采样到时，需要将其TD-error设置为最大，以保证最近的经验更容易被采样到。</li>
<li>只有在从经验池中抽取到某个经验并进行学习后，才对其TD-error进行计算更新。</li>
</ol>
<h1 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h1><p>算法：</p>
<ul>
<li>DQN</li>
<li>优化后的Double DQN</li>
<li>为了算法稳定的原因，将reward和TD-error clip到[-1,1]</li>
</ul>
<p>优先经验池：</p>
<ul>
<li><p>经验池大小$10^{6}$</p>
</li>
<li><p>batch-size为32</p>
</li>
<li><p>K=4，即每采样4次学习一次</p>
</li>
<li><p>Rank-based：$\alpha=0.7，\beta_{0}=0.5$，Proportional：$\alpha=0.6，\beta_{0}=0.4$</p>
</li>
<li><blockquote>
<p>These choices are trading off aggressiveness with robustness, but it is easy to revert to a behavior closer to the baseline by reducing $\alpha$ and/or increasing $\beta$. </p>
</blockquote>
</li>
</ul>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><h3 id="学习速度"><a href="#学习速度" class="headerlink" title="学习速度"></a>学习速度</h3><p><img src="./Prioritized-Experience-Replay/learning-speed.png" alt=""></p>
<ul>
<li>黑色代表不使用优先经验回放的DDQN</li>
<li>蓝色代表使用Proportional Prioritization的DDQN</li>
<li><p>红色代表使用Rank-based Prioritization的DDQN</p>
</li>
<li><p>绿色的虚线为人类水平</p>
</li>
</ul>
<h3 id="归一化得分"><a href="#归一化得分" class="headerlink" title="归一化得分"></a>归一化得分</h3><p>这些度量不重要，重要的是使用了优先经验回放机制的确提升了2倍左右的性能。</p>
<p><img src="./Prioritized-Experience-Replay/normalized-score1.png" alt=""></p>
<p><img src="./Prioritized-Experience-Replay/normalized-score.png" alt=""></p>
<h1 id="PER的代码"><a href="#PER的代码" class="headerlink" title="PER的代码"></a>PER的代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from abc import ABC, abstractmethod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Buffer(ABC):</span><br><span class="line">    @abstractmethod</span><br><span class="line">    def sample(self) -&gt; list:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">class Sum_Tree(object):</span><br><span class="line">    def __init__(self, capacity):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        capacity = 5，设置经验池大小</span><br><span class="line">        tree = [0,1,2,3,4,5,6,7,8,9,10,11,12] 8-12存放叶子结点p值，1-7存放父节点、根节点p值的和，0存放树节点的数量</span><br><span class="line">        data = [0,1,2,3,4,5] 1-5存放数据， 0存放capacity</span><br><span class="line">        Tree structure and array storage:</span><br><span class="line">        Tree index:</span><br><span class="line">                    1         -&gt; storing priority sum</span><br><span class="line">              /          \ </span><br><span class="line">             2            3</span><br><span class="line">            / \          / \</span><br><span class="line">          4     5       6   7</span><br><span class="line">         / \   / \     / \  / \</span><br><span class="line">        8   9 10   11 12                   -&gt; storing priority for transitions</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        assert capacity &gt; 0</span><br><span class="line">        self.now = 0</span><br><span class="line">        self.parent_node_count = self.get_parent_node_count(capacity)</span><br><span class="line">        print(self.parent_node_count)</span><br><span class="line">        self.tree = np.zeros(self.parent_node_count + capacity + 1)</span><br><span class="line">        self.tree[0] = len(self.tree) - 1</span><br><span class="line">        self.data = np.zeros(capacity + 1, dtype=object)</span><br><span class="line">        self.data[0] = capacity</span><br><span class="line"></span><br><span class="line">    def add(self, p, data):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        p : property</span><br><span class="line">        data : [s, a, r, s_, done]</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        tree_index = self.now + self.parent_node_count + 1</span><br><span class="line">        self.data[self.now + 1] = data</span><br><span class="line">        self._updatetree(tree_index, p)</span><br><span class="line">        self.now += 1</span><br><span class="line">        if self.now &gt; self.data[0]:</span><br><span class="line">            self.now = 0</span><br><span class="line"></span><br><span class="line">    def _updatetree(self, tree_index, p):</span><br><span class="line">        diff = p - self.tree[tree_index]</span><br><span class="line">        self._propagate(tree_index, diff)</span><br><span class="line">        self.tree[tree_index] = p</span><br><span class="line"></span><br><span class="line">    def _propagate(self, tree_index, diff):</span><br><span class="line">        parent = tree_index // 2</span><br><span class="line">        self.tree[parent] += diff</span><br><span class="line">        if parent != 1:</span><br><span class="line">            self._propagate(parent, diff)</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def total(self):</span><br><span class="line">        return self.tree[1]</span><br><span class="line"></span><br><span class="line">    def get(self, seg_p_total):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        seg_p_total : The value of priority to sample</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        tree_index = self._retrieve(1, seg_p_total)</span><br><span class="line">        data_index = tree_index - self.parent_node_count</span><br><span class="line">        return (tree_index, data_index, self.tree[tree_index], self.data[data_index])</span><br><span class="line"></span><br><span class="line">    def _retrieve(self, tree_index, seg_p_total):</span><br><span class="line">        left = 2 * tree_index</span><br><span class="line">        right = left + 1</span><br><span class="line">#         left = 2 * tree_index + 1</span><br><span class="line">#         right = 2 * (tree_index + 1)</span><br><span class="line">        if left &gt;= self.tree[0]:</span><br><span class="line">            return tree_index</span><br><span class="line">        return self._retrieve(left, seg_p_total) if seg_p_total &lt;= self.tree[left] else self._retrieve(right, seg_p_total - self.tree[left])</span><br><span class="line"></span><br><span class="line">    def pp(self):</span><br><span class="line">        print(self.tree, self.data)</span><br><span class="line"></span><br><span class="line">    def get_parent_node_count(self, capacity):</span><br><span class="line">        i = 0</span><br><span class="line">        while True:</span><br><span class="line">            if pow(2, i) &lt; capacity &lt;= pow(2, i + 1):</span><br><span class="line">                return pow(2, i + 1) - 1</span><br><span class="line">            i += 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class PrioritizedReplayBuffer(Buffer):</span><br><span class="line">    def __init__(self, batch_size, capacity, alpha, beta, epsilon):</span><br><span class="line">        self.batch_size = batch_size</span><br><span class="line">        self.capacity = capacity</span><br><span class="line">        self._size = 0</span><br><span class="line">        self.alpha = alpha</span><br><span class="line">        self.beta = beta</span><br><span class="line">        self.tree = Sum_Tree(capacity)</span><br><span class="line">        self.epsilon = epsilon</span><br><span class="line">        self.min_p = np.inf</span><br><span class="line"></span><br><span class="line">    def add(self, p, *args):</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        input: priorities, [ss, as, rs, _ss, dones]</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        p = np.power(np.abs(p) + self.epsilon, self.alpha)</span><br><span class="line">        min_p = p.min()</span><br><span class="line">        if min_p &lt; self.min_p:</span><br><span class="line">            self.min_p = min_p</span><br><span class="line">        if hasattr(args[0], &apos;__len__&apos;):</span><br><span class="line">            for i in range(len(args[0])):</span><br><span class="line">                self.tree.add(p[i], tuple(arg[i] for arg in args))</span><br><span class="line">                if self._size &lt; self.capacity:</span><br><span class="line">                    self._size += 1</span><br><span class="line">        else:</span><br><span class="line">            self.tree.add(p, args)</span><br><span class="line">            if self._size &lt; self.capacity:</span><br><span class="line">                self._size += 1</span><br><span class="line"></span><br><span class="line">    def sample(self):</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        output: weights, [ss, as, rs, _ss, dones]</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        n_sample = self.batch_size if self.is_lg_batch_size else self._size</span><br><span class="line">        interval = self.tree.total / n_sample</span><br><span class="line">        segment = [self.tree.total - i * interval for i in range(n_sample + 1)]</span><br><span class="line">        t = [self.tree.get(np.random.uniform(segment[i], segment[i + 1], 1)) for i in range(n_sample)]</span><br><span class="line">        t = [np.array(e) for e in zip(*t)]</span><br><span class="line">        self.last_indexs = t[0]</span><br><span class="line">        return np.power(self.min_p / t[-2], self.beta), t[-1]</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def is_lg_batch_size(self):</span><br><span class="line">        return self._size &gt; self.batch_size</span><br><span class="line"></span><br><span class="line">    def update_priority(self, priority):</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        input: priorities</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        assert hasattr(priority, &apos;__len__&apos;)</span><br><span class="line">        assert len(priority) == len(self.last_indexs)</span><br><span class="line">        for i in range(len(priority)):</span><br><span class="line">            self.tree._updatetree(self.last_indexs[i], priority[i])</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-heart"></i>感谢您的阅读-------------</div>
    
</div>
      
    </div>

    <div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JS库 sweetalert 可修改路径 -->
  <script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <p><span>本文标题:</span><a href="/Prioritized-Experience-Replay.html">Prioritized Experience Replay</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 Keavnn 的个人博客">Keavnn</a></p>
  <p><span>发布时间:</span>2019年05月22日 - 08:05</p>
  <p><span>最后更新:</span>2019年10月16日 - 22:10</p>
  <p><span>原始链接:</span><a href="/Prioritized-Experience-Replay.html" title="Prioritized Experience Replay">http://StepNeverStop.github.io/Prioritized-Experience-Replay.html</a>
    <span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://StepNeverStop.github.io/Prioritized-Experience-Replay.html" aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="external nofollow" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-相同方式共享 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
    $(".fa-clipboard").click(function(){
      clipboard.on('success', function(){
        swal({   
          title: "",   
          text: '复制成功',
          icon: "success", 
          showConfirmButton: true
          });
    });
    });  
</script>


      
    </div>

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>如果您获得了帮助，也可以资助一下小的啦~</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏啦</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="Keavnn 微信">
        <p>微信</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="Keavnn 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/rl/" rel="tag"> <i class="fa fa-tag"></i> rl</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Evolution-Strategies-2017.html" rel="next" title="Evolution Strategies as a Scalable Alternative to Reinforcement Learning">
                <i class="fa fa-chevron-left"></i> Evolution Strategies as a Scalable Alternative to Reinforcement Learning
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Hindsight-Experience-Replay.html" rel="prev" title="Hindsight Experience Replay">
                Hindsight Experience Replay <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_inline_share_toolbox">
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5cefbfc88c13b0e7" async="async"></script>
</div>

      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80MTk0NS8xODQ5MQ=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/Kicon.jpg" alt="Keavnn">
            
              <p class="site-author-name" itemprop="name">Keavnn</p>
              <p class="site-description motion-element" itemprop="description">If it is to be, it is up to me.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">51</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">26</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/StepNeverStop" target="_blank" title="GitHub" rel="external nofollow">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:oooooooooooooooocoo@vip.qq.com" target="_blank" title="E-Mail" rel="external nofollow">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank" rel="external nofollow">
                <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons">
              </a>
            </div>
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                推荐阅读
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://bluefisher.github.io" title="Fisher Chang" target="_blank" rel="external nofollow">Fisher Chang</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#简介"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#文中精要"><span class="nav-number">2.</span> <span class="nav-text">文中精要</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#随机采样方法"><span class="nav-number">2.1.</span> <span class="nav-text">随机采样方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Proportional-Prioritization"><span class="nav-number">2.1.1.</span> <span class="nav-text">Proportional Prioritization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rank-based-Prioritization"><span class="nav-number">2.1.2.</span> <span class="nav-text">Rank-based Prioritization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#比较"><span class="nav-number">2.1.3.</span> <span class="nav-text">比较</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#偏差退火-Annealing-The-Bias"><span class="nav-number">2.2.</span> <span class="nav-text">偏差退火 Annealing The Bias</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#伪代码"><span class="nav-number">3.</span> <span class="nav-text">伪代码</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Sum-Tree"><span class="nav-number">4.</span> <span class="nav-text">Sum Tree</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#优先经验回放的特点"><span class="nav-number">5.</span> <span class="nav-text">优先经验回放的特点</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#实验结果"><span class="nav-number">6.</span> <span class="nav-text">实验结果</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#效果"><span class="nav-number">6.1.</span> <span class="nav-text">效果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#学习速度"><span class="nav-number">6.1.1.</span> <span class="nav-text">学习速度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#归一化得分"><span class="nav-number">6.1.2.</span> <span class="nav-text">归一化得分</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PER的代码"><span class="nav-number">7.</span> <span class="nav-text">PER的代码</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Keavnn</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">80.2k</span>
  
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>
</div>









<!-- <div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共80.2k字</span>
</div> -->
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>
